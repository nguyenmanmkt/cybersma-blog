---
title: "CVE-2024-1086: Lỗ hổng Linux Kernel bị khai thác bởi Ransomware"
date: 2025-11-05T07:02:37.211+07:00
draft: false
tags: ["An ninh mạng", "Lỗ hổng bảo mật", "Ransomware", "Tấn công mạng", "Bảo mật hệ thống", "Phòng thủ mạng", "Quản lý rủi ro", "Giám sát bảo mật", "Malware", "Threat Intelligence"]
categories: ["Cyber Security"]
---

**CVE-2024-1086** là một lỗ hổng nghiêm trọng loại **use-after-free** trong thành phần **`netfilter: nf_tables`** của Linux kernel, cho phép kẻ tấn công thực hiện **leo thang đặc quyền cục bộ** lên quyền root. Đáng báo động hơn, lỗ hổng này đã và đang bị các nhóm ransomware và các tác nhân đe dọa khác tích cực khai thác trong thực tế [1][2][4][5][6][7].

![CVE-2024-1086 Exploit Flow](Figure1.png)

---

### 1. Lỗ hổng CVE-2024-1086 là gì?

*   **Loại lỗ hổng:** Use-after-free (sử dụng vùng nhớ đã được giải phóng). Đây là một dạng lỗi bộ nhớ nguy hiểm, xảy ra khi chương trình cố gắng truy cập bộ nhớ sau khi nó đã được giải phóng [1][2][5][6][7].
*   **Thành phần bị ảnh hưởng:** Linux kernel, cụ thể là hệ thống con **`netfilter: nf_tables`**. `Netfilter` là một framework trong Linux kernel cho phép thực hiện các thao tác xử lý gói mạng như lọc, NAT (Network Address Translation) và phân tích gói [1][2][5][6][7].

---

### 2. Chi tiết kỹ thuật

Lỗ hổng này xuất phát từ việc xử lý không đúng các giá trị verdict (quyết định xử lý gói) trong các hàm xử lý gói thuộc `nf_tables` [4].

*   **Nguyên nhân kích hoạt:** Lỗi liên quan đến hàm `nft_verdict_init()` khi nó giải thích sai các giá trị verdict (ví dụ: `NF_DROP`), dẫn đến việc giải phóng bộ nhớ của gói quá sớm [4]. Các quá trình xử lý tiếp theo sau đó lại giả định rằng gói vẫn còn hợp lệ, gây ra tình trạng giải phóng bộ nhớ hai lần (double-free) và sử dụng vùng nhớ đã được giải phóng (use-after-free) [1][4].
*   **Các hàm liên quan chính:**
    *   `nft_verdict_init()` — Khởi tạo các verdict trong các quy tắc lọc gói.
    *   `nf_hook_slow()` — Xử lý các gói và có thể đưa ra các giả định sai về trạng thái bộ nhớ sau khi một commit bị hoàn nguyên [4].
*   **Điều kiện tiên quyết để khai thác:**
    *   **Unprivileged user namespaces** được bật (`CONFIG_USER_NS=y` và `sysctl kernel.unprivileged_userns_clone=1`).
    *   `nf_tables` được bật (`CONFIG_NF_TABLES=y`).
    *   Đây là cấu hình mặc định phổ biến trên các bản phân phối như Debian, Ubuntu, KernelCTF. Các bản phân phối khác cũng có thể dễ bị tấn công tùy thuộc vào cài đặt [3][4].
*   **Mã khai thác công khai:** Một mã khai thác chứng minh khái niệm (Proof-of-Concept - PoC) của "Notselwyn" đã được công bố, cho thấy khả năng leo thang đặc quyền đáng tin cậy trên các kernel bị ảnh hưởng [1][3][4].

---

### 3. Cơ chế leo thang đặc quyền

Kẻ tấn công khai thác lỗi **double-free** để kiểm soát vùng nhớ đã được giải phóng, từ đó cho phép:

*   Quét bộ nhớ vật lý để tìm địa chỉ cơ sở của kernel, vượt qua cơ chế **KASLR (Kernel Address Space Layout Randomization)** [4].
*   Ghi đè lên các biến kernel nhạy cảm như **`modprobe_path`**, sau đó kích hoạt thực thi một tệp được tạo sẵn để sinh ra một **shell với quyền root** [4].
*   Khi đã đạt được quyền root, kẻ tấn công có thể:
    *   Vô hiệu hóa các biện pháp bảo vệ điểm cuối (endpoint protection).
    *   Cài đặt tính năng duy trì quyền truy cập (persistence).
    *   Di chuyển ngang (lateral movement), trích xuất dữ liệu, hoặc triển khai các payload ransomware [2][4].

---

### 4. Các phiên bản Linux Kernel bị ảnh hưởng

*   Lỗ hổng cơ bản ảnh hưởng đến **tất cả các nhân Linux từ v3.15 đến v6.8-rc1** [1][3][8].
*   Hầu hết các khai thác đã được thử nghiệm và **rất đáng tin cậy trên các phiên bản từ v5.14 đến v6.6** (trừ các nhánh đã được vá):
    *   v5.15.149 và mới hơn
    *   v6.1.76 và mới hơn
    *   v6.6.15 và mới hơn [3]
*   Các bản phân phối lớn bị ảnh hưởng bao gồm: **Debian, Ubuntu, Red Hat, Fedora, Amazon Linux, Oracle Linux, Rocky Linux**, và nhiều bản khác [1][3][4][6][7].

---

### 5. Tình hình khai thác bởi Ransomware

*   **CISA đã báo cáo về việc các nhóm ransomware tích cực khai thác** lỗ hổng này, xác nhận việc sử dụng nó trong các cuộc tấn công thực tế [1][2].
*   Tính đến các khuyến nghị mới nhất, **tên cụ thể của các nhóm ransomware hoặc chiến dịch chưa được công bố công khai** [1][2].
*   CrowdStrike và các nhà nghiên cứu khác đã quan sát thấy mã PoC được điều chỉnh để triển khai ransomware trên các hệ thống chưa được vá lỗi [2][4].

---

### 6. Các bước giảm thiểu và vá lỗi

Để bảo vệ hệ thống khỏi CVE-2024-1086, các tổ chức và người dùng cần thực hiện các biện pháp sau:

*   **Nâng cấp lên các phiên bản kernel đã được vá lỗi:**
    *   v5.15.149 trở lên
    *   v6.1.76 trở lên
    *   v6.6.15 trở lên
    *   v6.8-rc2 trở lên [3][8]
*   **Đối với các doanh nghiệp:**
    *   Áp dụng các **bản cập nhật bảo mật** có sẵn từ nhà cung cấp của bạn (Debian, Ubuntu, Red Hat, Amazon Linux, SUSE, v.v.) [4][6][7].
*   **Các biện pháp giảm thiểu bổ sung:**
    *   Vô hiệu hóa **unprivileged user namespaces** nếu không cần thiết:


```sh
        sysctl -w kernel.unprivileged_userns_clone=0
```


        Biện pháp này chặn một trong các điều kiện tiên quyết để khai thác nhưng có thể ảnh hưởng đến các workload container [3][4].
    *   Hạn chế hoặc giám sát quyền truy cập vào các hệ thống đang chạy kernel dễ bị tấn công.
    *   Giám sát các tiến trình hoặc sự cố kernel có thể chỉ ra các nỗ lực khai thác.
    *   Cân nhắc vô hiệu hóa hoặc hạn chế `nf_tables` nếu khả thi.

---

### Kết luận

CVE-2024-1086 là một lời nhắc nhở rõ ràng về tầm quan trọng của việc cập nhật bảo mật định kỳ, đặc biệt là đối với các thành phần cốt lõi của hệ điều hành như Linux kernel. Với việc lỗ hổng này đang bị các nhóm ransomware tích cực khai thác, việc áp dụng các bản vá và triển khai các biện pháp giảm thiểu là cực kỳ cấp bách để bảo vệ hệ thống khỏi các cuộc tấn công leo thang đặc quyền và các hậu quả nghiêm trọng khác.

---

### Nguồn tham khảo

*   [1] SecurityAffairs: Old Linux Kernel flaw CVE-2024-1086 resurfaces in ransomware attacks. (2025-11-01)
*   [2] SOCPrime: CVE-2024-1086 Vulnerability: Critical Privilege Escalation... (2025-11-04)
*   [3] Notselwyn/CVE-2024-1086 GitHub repository. (Accessed 2025-11-04)
*   [4] CrowdStrike: Active Exploitation Observed for Linux Kernel Privilege Escalation Vulnerability. (2024-06-06)
*   [5] NVD NIST: CVE-2024-1086 Detail. (2025-02-13)
*   [6] Amazon Linux Security Center: CVE-2024-1086. (2024-07-10)
*   [7] SUSE: CVE-2024-1086 Common Vulnerabilities and Exposures. (2024-05-15)
*   [8] NetApp Security Advisory: CVE-2024-1086 Linux Kernel Vulnerability. (2024-06-14)