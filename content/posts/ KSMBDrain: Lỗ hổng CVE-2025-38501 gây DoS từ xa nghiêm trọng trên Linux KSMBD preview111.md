---
title: "KSMBDrain: Lỗ hổng CVE-2025-38501 gây DoS từ xa nghiêm trọng trên Linux KSMBD"
date: 2025-09-17T16:32:27.704+07:00
draft: false
tags: ["KSMBD", "DoS", "CVE-2025-38501", "KSMBDrain", "Linux kernel", "SMB", "vulnerability", "remote attack", "kernel patch", "exploit"]
categories: ["Cyber Security", "Software Tool"]
---

## Mở đầu

Trong bối cảnh các mối đe dọa an ninh mạng ngày càng tinh vi, việc theo dõi và khắc phục các lỗ hổng nghiêm trọng là ưu tiên hàng đầu của mọi quản trị viên hệ thống. Gần đây, một lỗ hổng từ chối dịch vụ (DoS) từ xa nghiêm trọng đã được phát hiện trong KSMBD – thành phần máy chủ SMB3 chạy trong nhân Linux. Lỗ hổng này, được định danh là **CVE-2025-38501** và mệnh danh là "KSMBDrain", cho phép kẻ tấn công làm gián đoạn hoàn toàn các dịch vụ SMB mà không cần bất kỳ xác thực nào, gây ra mối đe dọa đáng kể cho các hệ thống Linux bị ảnh hưởng.

![KSMBDrain CVE-2025-38501 DoS Attack on Linux KSMBD](/images/2025/ksmbdrain_cve-2025-38501.webp)

Bài viết này sẽ đi sâu vào chi tiết của CVE-2025-38501, giải thích cơ chế tấn công, tác động tiềm tàng và các biện pháp khắc phục cần thiết để bảo vệ hạ tầng của bạn.

## CVE-2025-38501 (KSMBDrain) là gì?

CVE-2025-38501 là một lỗ hổng từ chối dịch vụ từ xa (Remote Denial-of-Service - DoS) ảnh hưởng đến **KSMBD**, máy chủ SMB3 chạy trực tiếp trong nhân Linux. KSMBD đã được đưa vào nhân Linux từ phiên bản 5.15 [2, 7].

**Cơ chế tấn công:**
Kẻ tấn công khai thác lỗ hổng này bằng cách thiết lập các kết nối TCP tiêu chuẩn với dịch vụ KSMBD thông qua quá trình bắt tay ba bước thông thường. Tuy nhiên, sau khi kết nối được thiết lập, kẻ tấn công sẽ ngừng phản hồi các gói tin tiếp theo [1, 2, 7]. Mặc định, máy chủ KSMBD sẽ duy trì các kết nối "chết" này vô thời hạn, từng bước tiêu thụ toàn bộ các kết nối mà máy chủ có thể xử lý. Điều này dẫn đến việc cạn kiệt tài nguyên và ngăn chặn các máy khách SMB hợp pháp mới kết nối vào dịch vụ [1, 2, 7].

**Tác động:**
*   **Từ chối dịch vụ từ xa (Remote DoS):** Dịch vụ SMB trở nên không khả dụng, làm gián đoạn hoạt động của người dùng và ứng dụng phụ thuộc vào nó [1, 2].
*   **Không cần xác thực:** Kẻ tấn công không cần phải xác thực để thực hiện cuộc tấn công này [1, 2, 7].
*   **Dễ khai thác:** Mã khai thác Proof-of-Concept (PoC) công khai đã có sẵn, khiến việc khai thác trở nên dễ dàng [2].
*   **Khả năng gây DoS bởi một kẻ tấn công:** Do giới hạn kết nối cao và thời gian chờ tối thiểu cấu hình được, một kẻ tấn công duy nhất từ một địa chỉ IP có thể gây ra DoS [1, 2].

## Ảnh hưởng và Nguy cơ thực tế

Lỗ hổng này đặc biệt nguy hiểm vì KSMBD là một thành phần cốt lõi của nhân Linux, được sử dụng để cung cấp chia sẻ tệp SMB hiệu suất cao. Việc một dịch vụ quan trọng như vậy có thể bị vô hiệu hóa hoàn toàn từ xa và không cần xác thực gây ra rủi ro lớn cho tính sẵn sàng của hệ thống.

Điều quan trọng cần lưu ý là **CVE-2025-38501 khác biệt với các lỗ hổng KSMBD khác** đã được phát hiện trước đây, chẳng hạn như:
*   **CVE-2022-47939:** Một lỗ hổng thực thi mã từ xa (RCE) nghiêm trọng [5].
*   **CVE-2023-0210:** Một lỗi ảnh hưởng đến xác thực NTLMv2 của KSMBD, có thể gây ra lỗi hệ điều hành [4].

CVE-2025-38501 chỉ là một vector tấn công **từ chối dịch vụ** và không cho phép thực thi mã từ xa [1, 2, 7]. Tuy nhiên, tác động DoS vẫn là mối lo ngại lớn đối với các hệ thống sản xuất.

Mặc dù có thể cấu hình thời gian chờ kết nối tối thiểu (ví dụ: một phút), các nhà nghiên cứu đã chỉ ra rằng biện pháp này không hoàn toàn ngăn chặn được cuộc tấn công, vì kẻ tấn công vẫn có đủ thời gian để làm cạn kiệt tài nguyên trước khi kết nối bị đóng [1, 2].

## Biện pháp Khắc phục và Phòng ngừa

Để bảo vệ các hệ thống Linux của bạn khỏi cuộc tấn công KSMBDrain, điều quan trọng nhất là phải hành động ngay lập tức.

*   **Cập nhật Kernel Linux:**
    Biện pháp khắc phục chính là cập nhật kernel Linux lên phiên bản đã được vá. Lỗi này đã được sửa bằng commit `e6bb9193974059ddbb0ce7763fa3882bd60d4dc3` [2, 7]. Các quản trị viên hệ thống nên kiểm tra các bản cập nhật kernel có sẵn từ nhà cung cấp phân phối Linux của họ và áp dụng chúng càng sớm càng tốt.

*   **Các biện pháp giảm thiểu tạm thời (nếu chưa thể cập nhật kernel ngay lập tức):**
    *   **Giới hạn tốc độ kết nối (Connection Rate Limiting):** Cấu hình tường lửa hoặc các công cụ mạng để giới hạn số lượng kết nối TCP mới đến dịch vụ KSMBD từ một địa chỉ IP cụ thể trong một khoảng thời gian nhất định.
    *   **Quy tắc tường lửa (Firewall Rules):** Hạn chế quyền truy cập vào cổng SMB (thường là 445/TCP) chỉ từ các địa chỉ IP đáng tin cậy hoặc các mạng nội bộ nếu có thể, giảm thiểu phơi nhiễm với Internet công cộng [2, 7].

## Bảng Tóm tắt Lỗ hổng

| CVE ID           | Loại             | Tác động                       | Cần xác thực | Phiên bản Kernel bị ảnh hưởng | Bản vá có sẵn      |
|------------------|------------------|------------------------------|--------------|-----------------------------|--------------------|
| CVE-2025-38501   | DoS từ xa        | Dịch vụ SMB không khả dụng    | Không         | 5.15 trở lên                | Có (commit đã sửa) |

## Kết luận

Lỗ hổng CVE-2025-38501 (KSMBDrain) là một mối đe dọa nghiêm trọng đối với tính sẵn sàng của các dịch vụ SMB trên hệ thống Linux sử dụng KSMBD. Với khả năng gây DoS từ xa mà không cần xác thực và sự tồn tại của mã khai thác công khai, các quản trị viên hệ thống phải ưu tiên cập nhật kernel Linux để vá lỗi này.

Việc duy trì các hệ thống được cập nhật và áp dụng các biện pháp bảo mật tốt nhất là chìa khóa để bảo vệ hạ tầng của bạn khỏi các cuộc tấn công mạng ngày càng gia tăng.

## Nguồn tham khảo

1.  [Linux Kernel KSMBD Flaw Lets Remote Attackers Drain Server ...](https://gbhackers.com/linux-kernel-ksmbd-flaw/)
2.  [Linux Kernel Flaw Allows Remote DoS Attacks, PoC Available](https://securityonline.info/ksmbdrain-cve-2025-38501-linux-kernel-flaw-allows-remote-dos-attacks-poc-available/)
3.  [A Vulnerability in KSMBD for Linux Could Allow for Remote Code ...](https://its.ny.gov/2022-147)
4.  [CVE-2023-0210 Detail - NVD](https://nvd.nist.gov/vuln/detail/CVE-2023-0210)
5.  [CVE-2022-47939 critical vulnerability in Linux kernel `ksmbd` module](https://www.wiz.io/blog/cve-2022-47939-critical-vulnerability-linux-kernel-ksmbd-module-everything-you-ne)
6.  [Eternal-Tux: Crafting a Linux Kernel KSMBD 0-Click RCE Exploit ...](https://www.willsroot.io/2025/09/ksmbd-0-click.html)
7.  [oss-security - [CVE-2025-38501] Linux kernel: KSMBD service DoS ...](https://www.openwall.com/lists/oss-security/2025/09/15/2)
8.  [CVE-2023-0210 Impact, Exploitability, and Mitigation Steps | Wiz](https://www.wiz.io/vulnerability-database/cve/cve-2023-0210)
9.  [Linux Kernel ksmbd Integer Underflow Vulnerability - SonicWall](https://www.sonicwall.com/blog/linux-kernel-ksmbd-integer-underflow-vulnerability)
10. [ksmbd - Fuzzing Improvements and Vulnerability Discovery (2/3)](https://blog.doyensec.com/2025/09/02/ksmbd-2.html)