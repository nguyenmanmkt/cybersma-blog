---
title: "CVE-2025-59287: Lỗ hổng RCE chưa xác thực nghiêm trọng trong WSUS bị khai thác thực tế"
date: 2025-11-03T07:03:13.737+07:00
draft: false
tags: ["An ninh mạng", "Bảo mật hệ thống", "Lỗ hổng bảo mật", "Tấn công mạng", "Phòng thủ mạng", "Quản lý rủi ro", "Giám sát bảo mật", "Threat Intelligence", "Malware", "Ransomware", "WSUS", "RCE", "Unauthenticated RCE", "CVE"]
categories: ["Cyber Security"]
---

## Mở đầu

Trong bối cảnh các mối đe dọa mạng ngày càng tinh vi, việc Microsoft Windows Server Update Services (WSUS) trở thành mục tiêu của một lỗ hổng thực thi mã từ xa (RCE) chưa xác thực nghiêm trọng (CVE-2025-59287) là một cảnh báo khẩn cấp cho các tổ chức. Lỗ hổng này đang bị khai thác tích cực trong thực tế, đặt ra rủi ro đáng kể cho các hệ thống Windows Server trên toàn cầu [1, 2, 3, 6].

WSUS là một thành phần quan trọng trong việc quản lý và phân phối các bản cập nhật bảo mật cho các máy chủ và máy trạm Windows trong mạng doanh nghiệp. Tuy nhiên, chính vai trò trung tâm này đã biến WSUS thành một điểm yếu nghiêm trọng khi bị khai thác, cho phép kẻ tấn công kiểm soát toàn diện hệ thống và mở đường cho các cuộc tấn công sâu hơn vào cơ sở hạ tầng mạng [2, 3].

Bài viết này sẽ đi sâu vào chi tiết kỹ thuật của CVE-2025-59287, cơ chế khai thác, tác động tiềm tàng và các biện pháp giảm thiểu cần thiết để bảo vệ hệ thống của bạn.

![CVE-2025-59287 Explained: WSUS Unauthenticated RCE Vulnerability](WSUS-Remote-Code-Execution-ET-preview-oct25.png)

## Chi tiết kỹ thuật của CVE-2025-59287

CVE-2025-59287 là một lỗ hổng thực thi mã từ xa (RCE) chưa xác thực, xuất phát từ việc xử lý không an toàn dữ liệu không đáng tin cậy trong các dịch vụ web của WSUS [1, 2, 3, 5, 6].

*   **Nguyên nhân gốc rễ:** Lỗ hổng nằm ở việc giải tuần tự (deserialization) không an toàn các đối tượng được gửi đến WSUS. Cụ thể, nó liên quan đến cách WSUS xử lý một `AuthorizationCookie` được mã hóa thông qua các endpoint dễ bị tấn công như `GetCookie()` hoặc `SyncUpdates` trong các dịch vụ web báo cáo [1, 3, 5, 8].
*   **Cơ chế Deserialize:** Các endpoint này giải mã cookie và giải tuần tự nội dung của nó bằng cách sử dụng các cơ chế .NET không an toàn (ví dụ: `BinaryFormatter.Deserialize` hoặc `SoapFormatter`), mà không có quá trình kiểm tra kiểu dữ liệu đầy đủ [1, 3, 5, 8].
*   **Thực thi mã tùy ý:** Điều này cho phép kẻ tấn công từ xa, không cần xác thực, gửi một yêu cầu HTTP được chế tạo đặc biệt. Khi yêu cầu này được giải tuần tự, nó sẽ thực thi mã tùy ý trong ngữ cảnh của tiến trình máy chủ WSUS, thường với đặc quyền cấp **SYSTEM** — đặc quyền cao nhất trên hệ thống Windows [1, 3, 4, 5, 8].
*   **Các phiên bản bị ảnh hưởng:** Lỗ hổng ảnh hưởng đến Windows Server 2012, 2012 R2, 2016, 2019, 2022 (bao gồm 23H2) và 2025 có bật vai trò WSUS. Vai trò này không được bật theo mặc định [3, 4, 8].

## Cơ chế khai thác

Kẻ tấn công khai thác CVE-2025-59287 bằng cách lợi dụng quá trình giải tuần tự không an toàn của WSUS:

*   **Tạo payload:** Kẻ tấn công tạo một đối tượng được tuần tự hóa độc hại, mã hóa nó thành một `AuthorizationCookie` và gửi nó thông qua các endpoint WSUS liên quan (thường là `/ClientWebService/Client.asmx` hoặc `/ReportingWebService/ReportingWebService.asmx`) [1, 3, 5, 7, 8].
*   **Thực thi mã:** Khi WSUS nhận được yêu cầu, nó sẽ giải mã và giải tuần tự đối tượng, sau đó thực thi các lệnh được nhúng trong đó [1, 3, 5, 7, 8].
*   **Yêu cầu duy nhất:** Điều kiện tiên quyết duy nhất để cuộc tấn công thành công là có quyền truy cập mạng vào phiên bản WSUS dễ bị tấn công, thường qua các cổng **8530 (HTTP)** và **8531 (HTTPS)** [4, 5, 8].
*   **Hoạt động hậu khai thác:** Các hoạt động sau khai thác được quan sát bao gồm [1, 2, 4, 5, 7, 9]:
    *   Chạy Command Prompt hoặc PowerShell từ `w3wp.exe` (IIS worker) hoặc `wsusservice.exe`.
    *   Tải xuống các payload tiếp theo (thường là các payload đa tầng được giải mã).
    *   Trích xuất thông tin miền và mạng (ví dụ: thu thập thông tin xác thực).
    *   Exfiltrate kết quả đến các webhook từ xa hoặc hạ tầng C2 để có thể thực hiện các cuộc tấn công tiếp theo hoặc triển khai phần mềm độc hại. Đã quan sát thấy mã độc infostealer (*Skuld*) được triển khai [10].
    *   Thiết lập cơ chế duy trì quyền truy cập thông qua triển khai webshell [3, 5].

## Tác động

Tác động của CVE-2025-59287 là cực kỳ nghiêm trọng đối với các tổ chức:

*   **Thực thi mã từ xa hoàn toàn với quyền SYSTEM:** Kẻ tấn công có thể kiểm soát hoàn toàn WSUS và tiềm ẩn khả năng di chuyển ngang trong toàn bộ mạng [1, 2, 3, 8].
*   **Các kiểu tấn công:** Kẻ tấn công đã sử dụng lỗ hổng này để thực hiện các cuộc tấn công "pre-ransomware", đánh cắp dữ liệu nhạy cảm (như thông tin người dùng và miền) và triển khai các phần mềm độc hại dai dẳng như webshells hoặc infostealers [2, 5, 7, 10]. Các chiến dịch tấn công cho thấy sự chuẩn bị cho các hoạt động tiếp theo như di chuyển ngang và leo thang đặc quyền [1].
*   **Rủi ro hạ tầng quan trọng:** Do các máy chủ WSUS thường chạy trên cơ sở hạ tầng quan trọng (ví dụ: bộ điều khiển miền), việc bị xâm nhập có thể cho phép phân phối rộng rãi các bản cập nhật độc hại hoặc truy cập sâu vào môi trường doanh nghiệp [2, 3, 10]. CISA đã xếp hạng CVE-2025-59287 vào danh sách các lỗ hổng bị khai thác đã biết (Known Exploited Vulnerabilities) và yêu cầu các cơ quan liên bang Hoa Kỳ khắc phục trước ngày 14 tháng 11 năm 2025 [6].

## Biện pháp giảm thiểu

Để bảo vệ hệ thống khỏi CVE-2025-59287, các tổ chức cần thực hiện ngay các biện pháp sau:

*   **Áp dụng bản vá khẩn cấp mới nhất của Microsoft:** Cần triển khai bản vá ngoài băng tần mới nhất của Microsoft (phát hành vào hoặc sau ngày 23 tháng 10 năm 2025) cho CVE-2025-59287. Bản sửa lỗi Patch Tuesday ban đầu không đầy đủ, vì vậy chỉ bản cập nhật sau này mới có thể giảm thiểu hoàn toàn lỗ hổng [1, 4, 8, 9].
*   **Tắt vai trò WSUS:** Nếu vai trò WSUS không được sử dụng, hãy tắt nó. Chỉ các máy chủ có vai trò WSUS được bật mới dễ bị tấn công [3, 4, 8].
*   **Hạn chế truy cập mạng:** Hạn chế truy cập mạng vào các cổng WSUS (8530/8531) từ các mạng không đáng tin cậy [4, 5, 8].
*   **Giám sát các chỉ số khai thác (IOCs):**
    *   Tìm kiếm các tiến trình đáng ngờ được tạo ra bởi `w3wp.exe` hoặc `wsusservice.exe` (ví dụ: sinh ra PowerShell/cmd) [1, 9].
    *   Theo dõi các kết nối ra bên ngoài đến các webhook hoặc IP không quen thuộc, đặc biệt là các hạ tầng C2 [1, 9].
    *   Phát hiện bất kỳ hoạt động PowerShell hoặc Command Prompt trái phép nào [1, 2, 4, 5, 10].
    *   Kiểm tra sự hiện diện của mã độc infostealer (ví dụ: Skuld) và các hoạt động thu thập thông tin miền/dữ liệu bất thường [1, 9, 10].
*   **Săn lùng các cơ chế duy trì quyền truy cập:** Kiểm tra các webshells, các tác vụ đã lên lịch trái phép hoặc các phê duyệt cập nhật bị thay đổi trên WSUS [3, 5, 9].
*   **Hành động nhanh chóng:** Các nhóm bảo mật được khuyến khích hành động nhanh chóng; CISA đã đưa ra thời hạn giảm thiểu bắt buộc đối với các cơ quan liên bang Hoa Kỳ [1, 4, 6].

## Kết luận

CVE-2025-59287 là một lỗ hổng nghiêm trọng và đang được khai thác tích cực, đòi hỏi sự chú ý khẩn cấp từ các nhà quản trị hệ thống và đội ngũ an ninh mạng. Việc không vá lỗi kịp thời có thể dẫn đến việc kiểm soát hoàn toàn các máy chủ WSUS, mở ra cánh cửa cho các cuộc tấn công phức tạp hơn như đánh cắp dữ liệu và triển khai ransomware. Bằng cách ưu tiên các biện pháp giảm thiểu được nêu trên, các tổ chức có thể củng cố tư thế bảo mật của mình và bảo vệ cơ sở hạ tầng quan trọng khỏi các mối đe dọa đang phát triển.

## Nguồn tham khảo
1.  [https://orca.security/resources/blog/cve-2025-59287-critical-wsus-rce/](https://orca.security/resources/blog/cve-2025-59287-critical-wsus-rce/)
2.  [https://businessinsights.bitdefender.com/bitdefender-advisory-critical-unauthenticated-rce-windows-server-update-services-cve-2025-59287](https://businessinsights.bitdefender.com/bitdefender-advisory-critical-unauthenticated-rce-windows-server-update-services-cve-2025-59287)
3.  [https://unit42.paloaltonetworks.com/microsoft-cve-2025-59287/](https://unit42.paloaltonetworks.com/microsoft-cve-2025-59287/)
4.  [https://arcticwolf.com/resources/blog/microsoft-releases-emergency-patch-for-exploited-critical-remote-code-execution-vulnerability-cve-2025-59287/](https://arcticwolf.com/resources/blog/microsoft-releases-emergency-patch-for-exploited-critical-remote-code-execution-vulnerability-cve-2025-59287/)
5.  [https://socprime.com/blog/cve-2025-59287-detection/](https://socprime.com/blog/cve-2025-59287-detection/)
6.  [https://insights.integrity360.com/threat-advisories/microsoft-wsus-remote-code-execution-vulnerability-cve-2025-59287-in-active-exploitation?hs_amp=true](https://insights.integrity360.com/threat-advisories/microsoft-wsus-remote-code-execution-vulnerability-cve-2025-59287-in-active-exploitation?hs_amp=true)
7.  [https://www.picussecurity.com/resource/blog/cve-2025-59287-explained-wsus-unauthenticated-rce-vulnerability](https://www.picussecurity.com/resource/blog/cve-2025-59287-explained-wsus-unauthenticated-rce-vulnerability)
8.  [https://www.huntress.com/blog/exploitation-of-windows-server-update-services-remote-code-execution-vulnerability](https://www.huntress.com/blog/exploitation-of-windows-server-update-services-remote-code-execution-vulnerability)
9.  [https://www.helpnetsecurity.com/2025/10/30/wsus-vulnerability-infostealer-cve-2025-59287/](https://www.helpnetsecurity.com/2025/10/30/wsus-vulnerability-infostealer-cve-2025-59287/)
10. [https://news.sophos.com/en-us/2025/10/29/windows-server-update-services-wsus-vulnerability-abused-to-harvest-sensitive-data/](https://news.sophos.com/en-us/2025/10/29/windows-server-update-services-wsus-vulnerability-abused-to-harvest-sensitive-data/)
11. [https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-59287](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-59287)
12. [https://nvd.nist.gov/vuln/detail/CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)